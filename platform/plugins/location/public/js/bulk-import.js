(()=>{function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,o){if(!e)return;if("string"==typeof e)return t(e,o);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t(e,o)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,r=new Array(t);o<t;o++)r[o]=e[o];return r}$((function(){var t=$(".location-import"),o=t.find(".form-import-data"),r=new Dropzone(".location-dropzone",{url:t.data("upload-url"),method:"post",headers:{"X-CSRF-TOKEN":o.find("input[name=_token]").val()},previewTemplate:t.find("#preview-template").html(),autoProcessQueue:!1,chunking:!0,chunkSize:1048576,acceptedFiles:t.find(".location-dropzone").data("mimetypes"),maxFiles:1,maxfilesexceeded:function(e){this.removeFile(e)}});$(document).on("submit",".form-import-data",(function(a){a.preventDefault();var n=o.find("button[type=submit]"),l=[],i=function r(a){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,d=arguments.length>2?arguments[2]:void 0;$.ajax({url:t.data("validate-url"),type:"POST",data:{file:a,offset:i,limit:d},beforeSend:function(){0===i&&(o.find(".status-text").text(n.data("validating-text")),n.prop("disabled",!0).addClass("button-loading"),$(".main-form-message").hide())},success:function(t){var i=t.error,d=t.message,u=t.data;if(i)Botble.showError(d);else if(u&&u.count>0)o.find(".status-text").text(d),r(a,u.offset),l=[].concat(e(l),e(u.failed));else if(n.prop("disabled",!1).removeClass("button-loading"),l.length>0){var c=$("#imported-listing"),f=$(".show-errors"),m=$("#failure-template").html(),p="";l.forEach((function(e){p+=m.replace("__row__",e.row).replace("__errors__",e.errors.join(", "))})),f.show(),$(".main-form-message").show(),c.show().html(p)}else s(a)},error:function(e){Botble.handleError(e)}})},s=function e(a){var l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0;$.ajax({url:t.data("import-url"),type:"POST",data:{file:a,offset:l,limit:i},beforeSend:function(){0===l&&(o.find(".status-text").text(n.data("importing-text")),n.prop("disabled",!0).addClass("button-loading"))},success:function(l){var i=l.error,s=l.message,d=l.data;i?Botble.showError(s):d&&d.count>0?(e(a,d.offset),o.find(".status-text").text(s)):(Botble.showSuccess(s),n.prop("disabled",!1).removeClass("button-loading"),o.find(".status-text").hide(),Botble.unblockUI(o.find(".upload-form")),d.total_message&&(t.find(".main-form-message").show(),t.find(".success-message").show().text(d.total_message),r.removeAllFiles(!0)))},error:function(e){Botble.handleError(e),Botble.unblockUI(o.find(".upload-form"))}})};r.getQueuedFiles().length>0&&r.processQueue(),r.on("sending",(function(){Botble.blockUI({target:o.find(".upload-form"),iconOnly:!0,overlayColor:"none"}),o.find(".status-text").show().text(n.data("uploading-text")),n.prop("disabled",!0).addClass("button-loading")})),r.on("error",(function(e,t){Botble.showError(t.message)})),r.on("success",(function(e,t){var o=t.data;i(o.file_path)}))}));var a=$(".alert.alert-warning");a.length>0&&a.forEach((function(e){var t=localStorage.getItem("storage-alerts");if(t=t?JSON.parse(t):{},$(e).data("alert-id")){if(t[$(e).data("alert-id")])return void $(e).alert("close");$(e).removeClass("hidden")}})),a.on("closed.bs.alert",(function(e){var t=$(e.target).data("alert-id");if(t){var o=localStorage.getItem("storage-alerts");(o=o?JSON.parse(o):{})[t]=!0,localStorage.setItem("storage-alerts",JSON.stringify(o))}}));var n=!1;$(document).on("click",".download-template",(function(e){if(e.preventDefault(),!n){var t=$(e.currentTarget),o=t.data("extension"),r=t.html();$.ajax({url:t.data("url"),method:"POST",data:{extension:o},xhrFields:{responseType:"blob"},beforeSend:function(){t.html(t.data("downloading")),t.addClass("text-secondary"),n=!0},success:function(e){var o=document.createElement("a"),r=window.URL.createObjectURL(e);o.href=r,o.download=t.data("filename"),document.body.append(o),o.click(),o.remove(),window.URL.revokeObjectURL(r)},error:function(e){Botble.handleError(e)},complete:function(){setTimeout((function(){t.html(r),t.removeClass("text-secondary"),n=!1}),2e3)}})}}));var l=$("#available-remote-locations");if(l.length){var i=function(){$.ajax({url:l.data("url"),type:"GET",success:function(e){var t=e.error,o=e.message,r=e.data;t?Botble.showError(o):l.html(r)},error:function(e){Botble.handleError(e)}})};i(),$(document).on("click",".btn-import-location-data",(function(e){e.preventDefault(),$(".button-confirm-import").data("url",$(this).data("url")),$(".modal-confirm-import").modal("show")})),$(".button-confirm-import").on("click",(function(e){e.preventDefault();var t=$(e.currentTarget);t.addClass("button-loading");var o=t.data("url");$.ajax({url:o,type:"POST",success:function(e){var o=e.error,r=e.message;o?Botble.showError(r):(Botble.showSuccess(r),i()),t.closest(".modal").modal("hide"),t.removeClass("button-loading")},error:function(e){Botble.handleError(e),t.removeClass("button-loading")}})}))}}))})();